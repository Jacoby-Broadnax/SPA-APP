<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" href="/assets/logo.png">
    <meta name="apple-mobile-web-app-title" content="SPA App">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#ffffff">
    <script src="https://cdn.jsdelivr.net/npm/webauthn-simple-app/dist/webauthn-simple-app.umd.js"></script>
    <title>SPA App</title>
    <link rel= 'stylesheet' href="/main.css">
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.12/handlebars.min.js"></script>
   
    <script src="/navController.js"></script>
    <script src="/actionSheet.js"></script>
 
    <link rel="stylesheet" href="/vivify.min.css">
    <meta name="theme-color" content="#171717">
</head>
<body onload="document.getElementById('dyn-sheet').style.display = 'none';">

<div class="item-loader" id="item-loader">
    <img  src="https://i.gifer.com/ZZ5H.gif">
    <p>Loading Product...</p>
</div>

<script>
    function authenticationInit(){
        var waApp = new WebAuthnApp()
waApp.username = "me";
waApp.register()
    .then(() => {
        alert("You are now registered!");
    })
    .catch((err) => {
        alert("Registration error: " + err.message);
    });
    }
    // register a new device / account

    </script>

<!----------------------Initial Screen-------------------->

<div id="initial" class="initial">
    <div class="initial-wrapper">
        <div class="initial-text">
            <h2>Welcome To The SPA App</h2>
            <p>Scholastic Products & Awards</p>
        </div>

        <div class="initial-feed">
            <div class="feed-item">
             <img src="/assets/searchblue.svg">
             <div class="feed-text">
                 <h3>Search</h3>
                 <p>Search through our large catalog of quality products. Find the right product for you.</p>
             </div>   
            </div>

            <div class="feed-item">
                <img src="/assets/rewardblue.svg">
                <div class="feed-text">
                    <h3>Rewards</h3>
                    <p>With every purchase get reward points. Redeem those points for free products</p>
                </div>   
               </div>

               <div class="feed-item">
                <img src="/assets/profileblue.svg">
                <div class="feed-text">
                    <h3>Account</h3>
                    <p>With an account quickly make payments and have all of your info saved for the next one. </p>
                </div>   
               </div>
        </div>

        <div class="wrap-fixed">
        <div class="large-wrap">
            <button onclick="document.getElementById('signup').style.display='block';document.getElementById('initial').style.display='block';document.getElementById('homepage').style.display='none';" class="large-confirm">Get Started</button>
        </div>
    </div>
    </div>
</div>


<!----------------------Sign up Form-------------------->

<div id="signup" class="signup vivify fadeInRight duration-300">
    <div class="signup-wrapper">
        <h1>Sign Up</h1>
    </div>
    <form class="form" onsubmit="document.getElementById('signup').style.display='none';document.getElementById('shipping').style.display='block';    document.getElementById('pIcon').src = 'logo/' + localStorage.getItem('dataschool') + '.jpg';document.getElementById('fy1img').src = 'logo/' + localStorage.getItem('dataschool') + '.jpg';document.getElementById('fy1icon').src = 'logo/' + localStorage.getItem('dataschool') + '.jpg';document.getElementById('fy1title').innerHTML= localStorage.getItem('dataschool');;return false;">

        <div class="halfed-input">
            <div class="halfed first-half">
                <label>First Name*</label>
                <br>
                <input required oninput="accountStore('fname', document.getElementById('fname').value)" class="text-input " id="fname" type="text">
            </div>
            
            <div class="halfed">
                <label>Last Name*</label>
                <br>
                <input required oninput="accountStore('lname', document.getElementById('lname').value)" class="text-input " id="lname" type="text">
            </div>   
        </div>

        

        <label>Email*</label>
        <br>
        <input required oninput="accountStore('email', document.getElementById('email').value)" class="text-input flattened" type="email" id="email">

        

        <div class="halfed-input">
            <div class=" halfed first-half">
                <label>Phone Number*</label>
                <br>
                <input required oninput="accountStore('number', document.getElementById('number').value)" class="text-input " id="number" type="tel">
            </div>
         
            <div class=" halfed">
                <label>School*</label>
                <br>
               <div id="schools">
                   </div>
            </div>   
        </div>

        <button type="submit" class="large-confirm form-submit">Submit</button>
    </form>
</div>



<!----------------------Address Form-------------------->

<div id="shipping" class="shipping vivify fadeInRight duration-300">
    <div class="signup-wrapper">
        <h1>Shipping</h1>
    </div>
    <form onsubmit="document.getElementById('signup').style.display='none';document.getElementById('shipping').style.display='none';document.getElementById('initial').style.display='none';document.getElementById('homepage').style.display='block';localStorage.setItem('userState', 'true');document.getElementById('pIcon').src = 'logo/' + localStorage.getItem('dataschool') + '.jpg';document.getElementById('fy1img').src = 'logo/' + localStorage.getItem('dataschool') + '.jpg';document.getElementById('fy1icon').src = 'logo/' + localStorage.getItem('dataschool') + '.jpg';document.getElementById('fy1title').innerHTML= localStorage.getItem('dataschool');;return false;" class="form">

        
        <label>Street Address</label>
        <br>
        <input oninput="accountStore('address', document.getElementById('saddress').value)"  class="text-input flattened" type="text" id="saddress" required>

        <label>Apartment, suite, etc</label>
        <br>
        <input oninput="accountStore('apt', document.getElementById('apt').value)"  class="text-input flattened" type="text" id="apt">

        

        <div class="halfed-input">
            <div class="halfed first-half">
                <label>City</label>
                <br>
                <input oninput="accountStore('city', document.getElementById('city').value)"  required class="text-input " id="city" type="text">
            </div>
            
            <div class="halfed">
                <label>State</label>
                <br>
                <input oninput="accountStore('state', document.getElementById('state').value)"  required class="text-input " id="state" type="text">
            </div>   
        </div>

        <label>Zip Code</label>
        <br>
        <input oninput="accountStore('zip', document.getElementById('zip').value)"  required class="text-input flattened" type="text" id="zip">


  
<div class="button-wrapper">
    <button type="submit" class="large-confirm form-submit">Save Address</button>

    <button onclick="document.getElementById('shipping').style.display='none';document.getElementById('initial').style.display='none';document.getElementById('homepage').style.display='block'; localStorage.setItem('userState', 'true');document.getElementById('pIcon').src = 'logo/' + localStorage.getItem('dataschool') + '.jpg';document.getElementById('fy1img').src = 'logo/' + localStorage.getItem('dataschool') + '.jpg';document.getElementById('fy1icon').src = 'logo/' + localStorage.getItem('dataschool') + '.jpg';document.getElementById('fy1title').innerHTML= localStorage.getItem('dataschool');" class="large-confirm form-submit">Skip</button>
</div>
       
    </form>
</div>

<div onclick="cartNav()" id="cartConfirm" class="cart-confirm">
    <div class="confirm-wrapper">
        <img src="/assets/shopping_cart_black_24dp.svg">
        <div class="confirm-text">
            <h4>Added To Cart</h4>
            <p id="cartItem">Placeholder Text</p>
        </div>
    </div>
    
</div>

<section id="cartpage">
    <div class="cart-empty " id="cartEmpty">
       <h3 class="vivify fadeIn">Your Carts Empty</h3> 
    </div>
    <iframe class="cart-frame" id="cartFrame" src="https://spa.ms/cart"></iframe>
    </section>


   <section id="homepage">
       <h1 onclick="authenticationInit()" class="page-title">Home</h1>

   
           <img id="pIcon" class="profile-icon" src="/assets/logo.png">
           
    <div class="search-wrapper">
        <div class="search-field">
            <img src="/assets/search-24px (1).svg">
            <input placeholder="" class="search-input" type="text">
        </div>
    </div>

    <div class="product-wrapper">
        <div class="product-title">
            <h2 class="vivify fadeIn duration-300">For You</h2>
        </div>
     <div class="product-list">
        <div class="product-spacer"></div>

  <script>
      function mascotPKG(){
    fetch('https://api.sheety.co/1c0174d5b32dbebdf6f1e14d6ba67a4f/scholastic/schools?filter[school]=' + localStorage.getItem('dataschool'), { 
  method: 'GET'
})
.then(function(response) { return response.json(); })
.then(function(schools) {
  console.log(schools.schools[0].prop)
dynSheet(localStorage.getItem('dataschool'), 'https://spa.ms/senior-products/#WidgetStore' + schools.schools[0].prop )
});  
}
      </script>
    <div onclick="mascotPKG();" class="product-item vivify fadeIn delay-{{id}}00" style="border: none;">
        <img id="fy1img" src="gradproducts/grad{{id}}.webp">
        <div class="icon-img">
            <img id="fy1icon" src="/assets/logo.png">
        </div>
        <div class="product-text">
            <h3 id="fy1sum">Mascot Package</h3>
            <p id="fy1title">{{title}}</p>
        </div>
    </div>


    <div onclick="dynSheet('Class Announcements', 'https://spa.ms/official-graduate-announcements/')" class="product-item vivify fadeIn delay-{{id}}00" >
        <img id="fy2img" src="gradproducts/grad{{id}}.webp">
 
        <div class="product-text">
            <h3 id="fy2sum">Class Announcements</h3>
            <p id="fy2title">{{title}}</p>
        </div>
    </div>
     

      </div>
      </div>   
<div class="item-wrapper" id="gradproducts"></div>
<div class="item-wrapper" id="gear"></div>
<div class="item-wrapper" id="rings"></div>

</section>


<div id="dyn-sheet" class="dyn-sheet ">
<div class="sheet-title">
    <div class="title-wrapper">
        <h2 id="sheetTitle">An Error Occured</h2>
    </div>
  
    <button onclick="dynClose()" class="close-sheet">Done</button>
</div>
<div class="product-overlay">
    <img src="/gradproducts/grad11.webp">
    <h4>2021 Sherpa Style Pullover</h4>
</div>
<iframe onload="document.getElementById('item-loader').style.display='none';" id="sheetFrame" class="sheet-frame vivify fadeIn duration-300 delay-1250" src="https://spa.ms/test2/?utm_source=rss&utm_medium=rss&utm_campaign=test2"></iframe>
</div>

<div class="bottom-navigation">
    <div class="bottom-wrapper">
        <button id="lIcon" onclick="listenNav()" class="default bottom-item ">
            <div class="bottom-icon">
                <img class="default-icon bicon" id="bicon1" src="Assets/home-24px.svg">
            </div>
            <p id="s1text">Home</p>
        </button>
 
        <button id="eIcon" onclick="eventsNav()" class="bottom-item">
         <div class="bottom-icon">
             <img id="bicon2" class="bicon" src="assets/account_circle-24px.svg">
         </div>
         <p id="s2text">Rewards</p>
     </button>
 
     <button id="cIcon" onclick="cartNav()" class="bottom-item">
         <div  class="bottom-icon">
             <img class="bicon" id="bicon3" src="Assets/shopping_cart-24px (3).svg">
         </div>
         <p id="s3text">Cart</p>
     </button>
 
     <button id="coIcon" onclick="contactNav()" class="bottom-item">
         <div class="bottom-icon">
             <img class="bicon" id="bicon4" src="assets/payment_black_24dp.svg">
         </div>
         <p id="s4text">Payments</p>
     </button>
    </div>
 </div>
 <script src="/accountHandler.js"></script>
 <script type="text/javascript">
    $(document).ready(function () {
      $.getJSON('https://api.sheety.co/1c0174d5b32dbebdf6f1e14d6ba67a4f/spa/gradproducts', function (data) {
        var template = Handlebars.compile($('#item-templateA').html())
        $('#gradproducts').html(template(data.gradproducts))
      })
    })
  </script>

  <script id="item-templateA" type="text/x-handlebars-template">
    <div class="product-wrapper">
        <div class="product-title">
            <h2 class="vivify fadeIn duration-300">Senior Grad Products</h2>
        </div>
     <div class="product-list">
        <div class="product-spacer"></div>
    {{#each this}}
  
    <div onclick="dynSheet('{{title}}', '{{url}}')" class="product-item vivify fadeIn delay-{{id}}00">
        <img src="gradproducts/grad{{id}}.webp">
        <div class="product-text">
            <h3>${{summary}}.00</h3>
            <p>{{title}}</p>
        </div>
    </div>
     
      {{/each}}
      </div>
      </div>   
  </script>


  <script type="text/javascript">
    $(document).ready(function () {
      $.getJSON('https://api.sheety.co/1c0174d5b32dbebdf6f1e14d6ba67a4f/spa/gear', function (data) {
        var template = Handlebars.compile($('#item-templateB').html())
        $('#gear').html(template(data.gear))
      })
    })
  </script>

  <script id="item-templateB" type="text/x-handlebars-template">
    <div class="product-wrapper">
        <div class="product-title">
            <h2 class="vivify fadeIn duration-300">Class Gear</h2>
        </div>
     <div class="product-list">
        <div class="product-spacer"></div>
    {{#each this}}
  
    <div onclick="dynSheet('{{title}}', '{{url}}')" class="product-item vivify fadeIn delay-{{id}}00">
        <img src="gear/gear{{id}}.png">
        <div class="product-text">
            <h3>${{summary}}</h3>
            <p>{{title}}</p>
        </div>
    </div>
     
      {{/each}}
      </div>
      </div>   
  </script>


  
  <script type="text/javascript">
    $(document).ready(function () {
      $.getJSON('https://api.sheety.co/1c0174d5b32dbebdf6f1e14d6ba67a4f/spa/rings', function (data) {
        var template = Handlebars.compile($('#item-templateC').html())
        $('#rings').html(template(data.rings))
      })
    })
  </script>

  <script id="item-templateC" type="text/x-handlebars-template">
    <div class="product-wrapper">
        <div class="product-title">
            <h2 class="vivify fadeIn duration-300">Mens Rings</h2>
        </div>
     <div class="product-list">
        <div class="product-spacer"></div>
    {{#each this}}
  
    <div onclick="dynSheet('{{title}}', '{{url}}')" class="product-item vivify fadeIn delay-{{id}}00">
     
        <img src="rings/{{title}}.png">
        <div class="product-text">
            <h3>${{summary}}</h3>
            <p>{{title}}</p>
        </div>
    </div>
     
      {{/each}}
      </div>
      </div>   
  </script>



  <script type="text/javascript">
    $(document).ready(function () {
      $.getJSON('https://api.sheety.co/1c0174d5b32dbebdf6f1e14d6ba67a4f/scholastic/schools', function (data) {
        var template = Handlebars.compile($('#item-templateE').html())
        $('#schools').html(template(data.schools))
      })
    })
  </script>

  <script id="item-templateE" type="text/x-handlebars-template">

    <select required onchange="accountStore('school', document.getElementById('school').value)" id="school" class="text-input select-input">
        <option value="" selected disabled hidden>Select School</option>

    {{#each this}}
  
   <option value="{{school}}">{{school}}</option>
     
      {{/each}}
    </select>  
  </script>
  <script>
  window.addEventListener('message', function(e) {
  if(e.data == "addCart"){
   document.getElementById('dyn-sheet').style.display='none'
   document.getElementById('cartItem').innerHTML = document.getElementById('sheetTitle').innerHTML;
   document.getElementById('cartFrame').src="https://spa.ms/cart";
   localStorage.setItem('cartState', 'true');

   setTimeout(function(){  
    document.getElementById('cartConfirm').style.bottom = "96px"
}, 500);
setTimeout(function(){  
    document.getElementById('cartConfirm').style.bottom = "-70px"
}, 4500);
cartCheck()
   
  }

  if(e.data == "emptyCart"){
    localStorage.setItem('cartState', 'false');
    cartCheck()
  }
});

function cartCheck(){
    if(localStorage.getItem('cartState') == null){
    document.getElementById('cartEmpty').style.display= 'block';
}

if(localStorage.getItem('cartState') == 'false'){
    document.getElementById('cartEmpty').style.display= 'block';
}

if(localStorage.getItem('cartState') == 'true'){
    document.getElementById('cartEmpty').style.display= 'none';
}
}

cartCheck();





  </script>
</body>
</html>